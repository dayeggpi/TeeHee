<Window x:Class="TeeHee.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TeeHee"
        xmlns:emoji="clr-namespace:Emoji.Wpf;assembly=Emoji.Wpf"		
        Title="TeeHee" 
        Height="800" Width="900"
        MinHeight="800" MinWidth="700"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource BackgroundBrush}"
        Closing="Window_Closing">
    
    <Window.Resources>
        <local:TruncateConverter x:Key="TruncateConverter"/>
    </Window.Resources>
   
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- HEADER BAR -->
        <Border Grid.Row="0" 
                BorderBrush="{DynamicResource BorderBrush}" 
                BorderThickness="0,0,0,1"
                Padding="20,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Logo -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="TeeHee" 
                               FontSize="18" 
                               FontWeight="SemiBold" 
                               Foreground="{DynamicResource TextBrush}"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="Type less, do more" 
                               FontSize="12" 
                               Foreground="{DynamicResource TextMutedBrush}"
                               VerticalAlignment="Center"
                               Margin="10,0,0,0"/>
                </StackPanel>

				<!-- Right Controls -->
				<StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
					
					<Button Content="+ New Trigger" 
							Style="{StaticResource PrimaryButton}"
							Click="NewTrigger_Click"
							Margin="0,0,16,0"/>
					
					<Button x:Name="ThemeButton" 
							Content="&#x2600;" 
							Style="{StaticResource IconButton}"
							ToolTip="Switch theme"
							FontSize="18"
							Width="36"
							Click="Theme_Click"
							Margin="0,0,8,0"/>
					
					<StackPanel Orientation="Horizontal" VerticalAlignment="Center" Width="70">
						<TextBlock x:Name="StatusLabel" 
								   Text="ON" 
								   FontSize="11"
								   FontWeight="SemiBold"
								   Foreground="{DynamicResource SuccessBrush}"
								   VerticalAlignment="Center"
								   Width="24"
								   Margin="0,0,2,0"/>
						<ToggleButton x:Name="MainToggle" 
									  Style="{StaticResource ToggleSwitch}"
									  IsChecked="True"
									  Click="MainToggle_Click"/>
					</StackPanel>
				</StackPanel>
            </Grid>
        </Border>

        <!-- MAIN CONTENT -->
        <Grid Grid.Row="1" Margin="20,16,20,20">
            <TabControl>
			<!-- TRIGGERS TAB -->
                <TabItem Header="Triggers">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Filter Bar -->
                        <Grid Grid.Row="0" Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" 
                                       Text="Category" 
                                       Foreground="{DynamicResource TextMutedBrush}" 
                                       FontSize="12"
                                       VerticalAlignment="Center"
                                       Margin="0,0,10,0"/>
                            <ComboBox x:Name="CategoryFilter" 
                                      Grid.Column="1"
                                      SelectionChanged="CategoryFilter_SelectionChanged"/>
                            
                            <Button Grid.Column="3" 
                                    Content="i Info"
                                    Style="{StaticResource IconButton}"
                                    Padding="10,6"
                                    Click="Info_Click"/>
                        </Grid>

                        <!-- Trigger List -->
                        <Border Grid.Row="1" 
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="8">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Column Headers -->
                                <Grid Grid.Row="0" Margin="12,10,12,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="140"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="80"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="TRIGGER" FontSize="10" FontWeight="SemiBold" 
                                               Foreground="{DynamicResource TextMutedBrush}" 
                                               Padding="8,0"/>
                                    <TextBlock Grid.Column="1" Text="CATEGORY" FontSize="10" FontWeight="SemiBold" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                    <TextBlock Grid.Column="2" Text="EXPANSION" FontSize="10" FontWeight="SemiBold" 
                                               Foreground="{DynamicResource TextMutedBrush}"/>
                                    <TextBlock Grid.Column="3" Text="ACTIONS" FontSize="10" FontWeight="SemiBold" 
                                               Foreground="{DynamicResource TextMutedBrush}" 
                                               HorizontalAlignment="Right"
                                               Margin="0,0,8,0"/>
                                </Grid>
                                
                                <!-- List -->
                                <ListBox x:Name="TriggerList" 
                                         Grid.Row="1"
                                         Margin="4,8,4,4"
                                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                                         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
									<ListBox.ItemTemplate>
										<DataTemplate>
											<Grid Background="Transparent">
												<Grid.ColumnDefinitions>
													<ColumnDefinition Width="132"/>
													<ColumnDefinition Width="100"/>
													<ColumnDefinition Width="*"/>
													<ColumnDefinition Width="Auto"/>
												</Grid.ColumnDefinitions>
												<emoji:TextBlock Grid.Column="0" 
														   Text="{Binding Input}" 
														   FontFamily="Segoe UI Emoji, Consolas"
														   FontSize="13"
														   Foreground="{DynamicResource PrimaryBrush}"
														   TextTrimming="CharacterEllipsis"
														   VerticalAlignment="Center"/>
												<emoji:TextBlock Grid.Column="1" 
														   Text="{Binding Category}" 
														   FontFamily="Segoe UI Emoji, Segoe UI"
														   FontSize="12"
														   Foreground="{DynamicResource TextMutedBrush}"
														   TextTrimming="CharacterEllipsis"
														   VerticalAlignment="Center"/>
												<emoji:TextBlock Grid.Column="2" 
														   Text="{Binding Output, Converter={StaticResource TruncateConverter}}" 
														   FontFamily="Segoe UI Emoji, Segoe UI"
														   FontSize="13"
														   Foreground="{DynamicResource TextBrush}"
														   VerticalAlignment="Center"
														   Margin="0,0,10,0"
														   ToolTipService.InitialShowDelay="1000"
														   ToolTipService.ShowDuration="60000"
														   ToolTipService.BetweenShowDelay="0">
													<TextBlock.ToolTip>
														<ToolTip>
															<TextBlock Text="{Binding Output}" 
																	   TextWrapping="Wrap"
																	   FontFamily="Segoe UI Emoji, Segoe UI"
																	   MaxWidth="400"/>
														</ToolTip>
													</TextBlock.ToolTip>
												</emoji:TextBlock>
												<StackPanel Grid.Column="3" 
															Orientation="Horizontal"
															VerticalAlignment="Center">
													<Button Content="&#x270E;" 
															Style="{StaticResource EditButton}"
															FontSize="14"
															Padding="6,4"
															ToolTip="Edit"
															Click="EditTrigger_Click"
															Tag="{Binding}"/>
													<Button Content="X" 
															Style="{StaticResource DangerButton}"
															FontSize="13"
															ToolTip="Delete"
															Click="DeleteTrigger_Click"
															Tag="{Binding}"/>
												</StackPanel>
											</Grid>
										</DataTemplate>
									</ListBox.ItemTemplate>
                                </ListBox>
                                
                                <!-- Empty State -->
                                <TextBlock x:Name="EmptyMessage" 
                                           Grid.Row="1"
                                           Text="No triggers yet. Click '+ New Trigger' to add one." 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"
                                           Foreground="{DynamicResource TextMutedBrush}"
                                           FontSize="13"
                                           Visibility="Collapsed"/>
                            </Grid>
                        </Border>
                    </Grid>
                </TabItem>
				
				<!-- TEST TAB -->
				<TabItem Header="Test">
					<Grid Margin="0,4,0,0">
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="*"/>
						</Grid.RowDefinitions>
						
						<StackPanel Grid.Row="0" Margin="0,0,0,12">
							<Grid>
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*"/>
									<ColumnDefinition Width="Auto"/>
								</Grid.ColumnDefinitions>
								<TextBlock Grid.Column="0"
										   Text="Test your triggers here. Type a trigger to see it expand." 
										   Foreground="{DynamicResource TextMutedBrush}" 
										   FontSize="12"/>
								<Button Grid.Column="1"
										Content="Clear"
										Style="{StaticResource SecondaryButton}"
										Padding="12,6"
										Click="ClearTestArea_Click"/>
							</Grid>
						</StackPanel>
						
						<Border Grid.Row="1"
								Background="{DynamicResource SurfaceBrush}"
								BorderBrush="{DynamicResource BorderBrush}"
								BorderThickness="1"
								CornerRadius="6">
							<emoji:RichTextBox x:Name="TestTextBox"
										 Background="Transparent"
										 Foreground="{DynamicResource TextBrush}"
										 BorderThickness="0"
										 Padding="10,8"
										 FontFamily="Segoe UI Emoji, Segoe UI"
										 FontSize="14"
										 AcceptsReturn="True"
										 VerticalScrollBarVisibility="Auto">
								<RichTextBox.Resources>
									<Style TargetType="Paragraph">
										<Setter Property="Margin" Value="0"/>
									</Style>
								</RichTextBox.Resources>
							</emoji:RichTextBox>
						</Border>
					</Grid>
				</TabItem>

				<!-- PLACEHOLDERS TAB -->
				<TabItem Header="Placeholders">
					<Grid Margin="0,4,0,0">
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="*"/>
						</Grid.RowDefinitions>
						
						<TextBlock Grid.Row="0"
								   Text="Use these placeholders in your trigger expansions. Click to copy." 
								   Foreground="{DynamicResource TextMutedBrush}" 
								   FontSize="12"
								   Margin="0,0,0,12"/>
						
						<Border Grid.Row="1" 
								Background="{DynamicResource SurfaceBrush}"
								BorderBrush="{DynamicResource BorderBrush}"
								BorderThickness="1"
								CornerRadius="8">
							<ListBox x:Name="PlaceholderList" 
									 Margin="4"
									 Background="Transparent"
									 BorderThickness="0"
									 ScrollViewer.VerticalScrollBarVisibility="Auto"
									 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
								<ListBox.ItemTemplate>
									<DataTemplate>
										<Grid Margin="4,2">
											<Grid.ColumnDefinitions>
												<ColumnDefinition Width="160"/>
												<ColumnDefinition Width="*"/>
												<ColumnDefinition Width="Auto"/>
											</Grid.ColumnDefinitions>
											<TextBlock Grid.Column="0" 
													   Text="{Binding Key}" 
													   FontFamily="Consolas"
													   FontSize="13"
													   Foreground="{DynamicResource PrimaryBrush}"
													   VerticalAlignment="Center"/>
											<TextBlock Grid.Column="1" 
													   Text="{Binding Value}" 
													   FontSize="12"
													   Foreground="{DynamicResource TextMutedBrush}"
													   VerticalAlignment="Center"/>
											<Button Grid.Column="2" 
													Content="Copy" 
													Style="{StaticResource SecondaryButton}"
													Padding="10,4"
													FontSize="11"
													Click="CopyPlaceholder_Click"
													Tag="{Binding Key}"/>
										</Grid>
									</DataTemplate>
								</ListBox.ItemTemplate>
							</ListBox>
						</Border>
					</Grid>
				</TabItem>
				
				<!-- SETTINGS TAB -->
                <TabItem Header="Settings">
                    <ScrollViewer x:Name="SettingsScrollViewer" 
                                  VerticalScrollBarVisibility="Auto" 
                                  Loaded="SettingsScrollViewer_Loaded"
                                  Margin="0,4,0,0">
                        <StackPanel>
                            
                            <!-- General Section -->
                            <TextBlock Text="General" 
                                       FontSize="11" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       Margin="0,0,0,10"/>
                            
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="16"
                                    Margin="0,0,0,20">
                                <StackPanel>
                                    <CheckBox x:Name="StartupCheckBox" 
                                              Content="Run TeeHee on Windows startup"
                                              Style="{StaticResource ModernCheckBox}"
                                              Checked="StartupCheckBox_Changed"
                                              Unchecked="StartupCheckBox_Changed"/>
                                    <CheckBox x:Name="MinimizeToTrayCheckBox" 
                                            Content="Minimize to tray when closing window" 
                                            IsChecked="{Binding Source={x:Static local:TriggerDatabase.Instance}, Path=Settings.MinimizeToTrayOnClose}"
                                            Style="{StaticResource ModernCheckBox}"
                                            Checked="MinimizeToTrayCheckBox_Changed"
                                            Unchecked="MinimizeToTrayCheckBox_Changed"
                                            Margin="0,8,0,0"/>                                              
                                </StackPanel>
                            </Border>
                            






                                    
                            <!-- Speed Section -->
                            <TextBlock Text="Trigger Speed" 
                                       FontSize="11" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       Margin="0,0,0,10"/>
                            
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="16"
                                    Margin="0,0,0,20">
                                <StackPanel>
                                    <TextBlock Text="Adjust how fast the text expansion happens" 
                                               Foreground="{DynamicResource TextMutedBrush}" 
                                               FontSize="12"
                                               Margin="0,0,0,14"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="50"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Slower" 
                                                   Foreground="{DynamicResource TextMutedBrush}" 
                                                   FontSize="11"
                                                   VerticalAlignment="Center"/>
                                        <Slider x:Name="SpeedSlider" 
                                                Grid.Column="1" 
                                                Minimum="1" Maximum="10" 
                                                Value="5"
                                                Style="{StaticResource ModernSlider}"
                                                Margin="10,0"
                                                ValueChanged="SpeedSlider_ValueChanged"/>
                                        <TextBlock Grid.Column="2" Text="Faster" 
                                                   Foreground="{DynamicResource TextMutedBrush}" 
                                                   FontSize="11"
                                                   VerticalAlignment="Center"
                                                   HorizontalAlignment="Right"/>
                                    </Grid>
                                    <TextBlock x:Name="SpeedValueText" 
                                               Text="Delay: 18ms" 
                                               Foreground="{DynamicResource TextMutedBrush}"
                                               FontSize="11"
                                               HorizontalAlignment="Center"
                                               Margin="0,10,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Data Section -->
                            <TextBlock Text="Database (Triggers)" 
                                       FontSize="11" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       Margin="0,0,0,10"/>
                            
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="16"
                                    Margin="0,0,0,20">
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="Export" 
                                            Style="{StaticResource SecondaryButton}"
                                            Click="Export_Click"
                                            Margin="0,0,10,0"/>
                                    <Button Content="Import" 
                                            Style="{StaticResource SecondaryButton}"
                                            Click="Import_Click"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Settings and Database Location Section -->
                            <TextBlock Text="Settings and Database Location" 
                                       FontSize="11" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       Margin="0,0,0,10"/>
                            
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="16"
                                    Margin="0,0,0,20">
                                <StackPanel>
                                    <TextBlock Text="Settings file (settings.json)" 
                                               Foreground="{DynamicResource TextMutedBrush}" 
                                               FontSize="11"
                                               Margin="0,0,0,4"/>
                                    <TextBox x:Name="SettingsPathTextBox" 
                                             Style="{StaticResource ModernTextBox}"
                                             IsReadOnly="True"
                                             FontSize="11"
                                             Margin="0,0,0,12"/>
                                    
                                    <TextBlock Text="Database file (triggers.json)" 
                                               Foreground="{DynamicResource TextMutedBrush}" 
                                               FontSize="11"
                                               Margin="0,0,0,4"/>
                                    <TextBox x:Name="DatabaseLocationText" 
                                             Style="{StaticResource ModernTextBox}"
                                             IsReadOnly="True"
                                             FontSize="11"
                                             Margin="0,0,0,12"/>
                                    
                                    <Button Content="Change Location..." 
                                            Style="{StaticResource SecondaryButton}"
                                            Click="ChangeLocationButton_Click"/>
                                </StackPanel>
                            </Border>
							<!-- About Section -->
                            <TextBlock Text="About" 
                                       FontSize="11" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextMutedBrush}"
                                       Margin="0,0,0,10"/>
                            
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="16">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Name" 
                                               Foreground="{DynamicResource TextMutedBrush}" FontSize="12"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="TeeHee" 
                                               Foreground="{DynamicResource TextBrush}" FontSize="12" FontWeight="Medium"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Version" 
                                               Foreground="{DynamicResource TextMutedBrush}" FontSize="12" Margin="0,6,0,0"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="0.9.3" 
                                               Foreground="{DynamicResource TextBrush}" FontSize="12" Margin="0,6,0,0"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Author" 
                                               Foreground="{DynamicResource TextMutedBrush}" FontSize="12" Margin="0,6,0,0"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Margin="0,6,0,0">
                                        <Hyperlink Click="Author_Click" 
                                                   Foreground="{DynamicResource PrimaryBrush}"
                                                   TextDecorations="None">
                                            dayeggpi
                                        </Hyperlink>
                                    </TextBlock>
                                </Grid>
                            </Border>
                            
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
                
            </TabControl>
        </Grid>
    </Grid>
</Window>